{"ast":null,"code":"function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}import{DEFAULT_TOUCH_SLOP}from'../constants';import{EventTypes}from'../interfaces';export default class ScaleGestureDetector{constructor(callbacks){_defineProperty(this,\"onScaleBegin\",void 0);_defineProperty(this,\"onScale\",void 0);_defineProperty(this,\"onScaleEnd\",void 0);_defineProperty(this,\"_focusX\",void 0);_defineProperty(this,\"_focusY\",void 0);_defineProperty(this,\"_currentSpan\",void 0);_defineProperty(this,\"prevSpan\",void 0);_defineProperty(this,\"initialSpan\",void 0);_defineProperty(this,\"currentTime\",void 0);_defineProperty(this,\"prevTime\",void 0);_defineProperty(this,\"inProgress\",false);_defineProperty(this,\"spanSlop\",void 0);_defineProperty(this,\"minSpan\",void 0);this.onScaleBegin=callbacks.onScaleBegin;this.onScale=callbacks.onScale;this.onScaleEnd=callbacks.onScaleEnd;this.spanSlop=DEFAULT_TOUCH_SLOP*2;this.minSpan=0;}onTouchEvent(event,tracker){this.currentTime=event.time;const action=event.eventType;const numOfPointers=tracker.trackedPointersCount;const streamComplete=action===EventTypes.UP||action===EventTypes.ADDITIONAL_POINTER_UP||action===EventTypes.CANCEL;if(action===EventTypes.DOWN||streamComplete){if(this.inProgress){this.onScaleEnd(this);this.inProgress=false;this.initialSpan=0;}if(streamComplete){return true;}}const configChanged=action===EventTypes.DOWN||action===EventTypes.ADDITIONAL_POINTER_UP||action===EventTypes.ADDITIONAL_POINTER_DOWN;const pointerUp=action===EventTypes.ADDITIONAL_POINTER_UP;const ignoredPointer=pointerUp?event.pointerId:undefined;const div=pointerUp?numOfPointers-1:numOfPointers;const coordsSum=tracker.getAbsoluteCoordsSum();const focusX=coordsSum.x/div;const focusY=coordsSum.y/div;let devSumX=0;let devSumY=0;tracker.trackedPointers.forEach((value,key)=>{if(key===ignoredPointer){return;}devSumX+=Math.abs(value.abosoluteCoords.x-focusX);devSumY+=Math.abs(value.abosoluteCoords.y-focusY);});const devX=devSumX/div;const devY=devSumY/div;const spanX=devX*2;const spanY=devY*2;const span=Math.hypot(spanX,spanY);const wasInProgress=this.inProgress;this._focusX=focusX;this._focusY=focusY;if(this.inProgress&&(span<this.minSpan||configChanged)){this.onScaleEnd(this);this.inProgress=false;this.initialSpan=span;}if(configChanged){this.initialSpan=this.prevSpan=this._currentSpan=span;}if(!this.inProgress&&span>=this.minSpan&&(wasInProgress||Math.abs(span-this.initialSpan)>this.spanSlop)){this.prevSpan=this._currentSpan=span;this.prevTime=this.currentTime;this.inProgress=this.onScaleBegin(this);}if(action!==EventTypes.MOVE){return true;}this._currentSpan=span;if(this.inProgress&&!this.onScale(this)){return true;}this.prevSpan=this.currentSpan;this.prevTime=this.currentTime;return true;}calculateScaleFactor(numOfPointers){if(numOfPointers<2){return 1;}return this.prevSpan>0?this.currentSpan/this.prevSpan:1;}get currentSpan(){return this._currentSpan;}get focusX(){return this._focusX;}get focusY(){return this._focusY;}get timeDelta(){return this.currentTime-this.prevTime;}}","map":{"version":3,"names":["DEFAULT_TOUCH_SLOP","EventTypes","ScaleGestureDetector","constructor","callbacks","_defineProperty","onScaleBegin","onScale","onScaleEnd","spanSlop","minSpan","onTouchEvent","event","tracker","currentTime","time","action","eventType","numOfPointers","trackedPointersCount","streamComplete","UP","ADDITIONAL_POINTER_UP","CANCEL","DOWN","inProgress","initialSpan","configChanged","ADDITIONAL_POINTER_DOWN","pointerUp","ignoredPointer","pointerId","undefined","div","coordsSum","getAbsoluteCoordsSum","focusX","x","focusY","y","devSumX","devSumY","trackedPointers","forEach","value","key","Math","abs","abosoluteCoords","devX","devY","spanX","spanY","span","hypot","wasInProgress","_focusX","_focusY","prevSpan","_currentSpan","prevTime","MOVE","currentSpan","calculateScaleFactor","timeDelta"],"sources":["/home/user/rork-vibesync-458/node_modules/react-native-gesture-handler/lib/module/web/detectors/ScaleGestureDetector.ts"],"sourcesContent":["import { DEFAULT_TOUCH_SLOP } from '../constants';\nimport { AdaptedEvent, EventTypes } from '../interfaces';\n\nimport PointerTracker from '../tools/PointerTracker';\n\nexport interface ScaleGestureListener {\n  onScaleBegin: (detector: ScaleGestureDetector) => boolean;\n  onScale: (detector: ScaleGestureDetector) => boolean;\n  onScaleEnd: (detector: ScaleGestureDetector) => void;\n}\n\nexport default class ScaleGestureDetector implements ScaleGestureListener {\n  public onScaleBegin: (detector: ScaleGestureDetector) => boolean;\n  public onScale: (detector: ScaleGestureDetector) => boolean;\n  public onScaleEnd: (detector: ScaleGestureDetector) => void;\n\n  private _focusX!: number;\n  private _focusY!: number;\n\n  private _currentSpan!: number;\n  private prevSpan!: number;\n  private initialSpan!: number;\n\n  private currentTime!: number;\n  private prevTime!: number;\n\n  private inProgress = false;\n\n  private spanSlop: number;\n  private minSpan: number;\n\n  constructor(callbacks: ScaleGestureListener) {\n    this.onScaleBegin = callbacks.onScaleBegin;\n    this.onScale = callbacks.onScale;\n    this.onScaleEnd = callbacks.onScaleEnd;\n\n    this.spanSlop = DEFAULT_TOUCH_SLOP * 2;\n    this.minSpan = 0;\n  }\n\n  public onTouchEvent(event: AdaptedEvent, tracker: PointerTracker): boolean {\n    this.currentTime = event.time;\n\n    const action: EventTypes = event.eventType;\n    const numOfPointers = tracker.trackedPointersCount;\n\n    const streamComplete: boolean =\n      action === EventTypes.UP ||\n      action === EventTypes.ADDITIONAL_POINTER_UP ||\n      action === EventTypes.CANCEL;\n\n    if (action === EventTypes.DOWN || streamComplete) {\n      if (this.inProgress) {\n        this.onScaleEnd(this);\n        this.inProgress = false;\n        this.initialSpan = 0;\n      }\n\n      if (streamComplete) {\n        return true;\n      }\n    }\n\n    const configChanged: boolean =\n      action === EventTypes.DOWN ||\n      action === EventTypes.ADDITIONAL_POINTER_UP ||\n      action === EventTypes.ADDITIONAL_POINTER_DOWN;\n\n    const pointerUp = action === EventTypes.ADDITIONAL_POINTER_UP;\n\n    const ignoredPointer: number | undefined = pointerUp\n      ? event.pointerId\n      : undefined;\n\n    // Determine focal point\n\n    const div: number = pointerUp ? numOfPointers - 1 : numOfPointers;\n\n    const coordsSum = tracker.getAbsoluteCoordsSum();\n\n    const focusX = coordsSum.x / div;\n    const focusY = coordsSum.y / div;\n\n    // Determine average deviation from focal point\n\n    let devSumX = 0;\n    let devSumY = 0;\n\n    tracker.trackedPointers.forEach((value, key) => {\n      if (key === ignoredPointer) {\n        return;\n      }\n\n      devSumX += Math.abs(value.abosoluteCoords.x - focusX);\n      devSumY += Math.abs(value.abosoluteCoords.y - focusY);\n    });\n\n    const devX: number = devSumX / div;\n    const devY: number = devSumY / div;\n\n    const spanX: number = devX * 2;\n    const spanY: number = devY * 2;\n\n    const span = Math.hypot(spanX, spanY);\n\n    // Begin/end events\n    const wasInProgress: boolean = this.inProgress;\n    this._focusX = focusX;\n    this._focusY = focusY;\n\n    if (this.inProgress && (span < this.minSpan || configChanged)) {\n      this.onScaleEnd(this);\n      this.inProgress = false;\n      this.initialSpan = span;\n    }\n\n    if (configChanged) {\n      this.initialSpan = this.prevSpan = this._currentSpan = span;\n    }\n\n    if (\n      !this.inProgress &&\n      span >= this.minSpan &&\n      (wasInProgress || Math.abs(span - this.initialSpan) > this.spanSlop)\n    ) {\n      this.prevSpan = this._currentSpan = span;\n      this.prevTime = this.currentTime;\n      this.inProgress = this.onScaleBegin(this);\n    }\n\n    // Handle motion\n    if (action !== EventTypes.MOVE) {\n      return true;\n    }\n\n    this._currentSpan = span;\n\n    if (this.inProgress && !this.onScale(this)) {\n      return true;\n    }\n\n    this.prevSpan = this.currentSpan;\n    this.prevTime = this.currentTime;\n\n    return true;\n  }\n\n  public calculateScaleFactor(numOfPointers: number): number {\n    if (numOfPointers < 2) {\n      return 1;\n    }\n\n    return this.prevSpan > 0 ? this.currentSpan / this.prevSpan : 1;\n  }\n\n  public get currentSpan() {\n    return this._currentSpan;\n  }\n\n  public get focusX() {\n    return this._focusX;\n  }\n\n  public get focusY() {\n    return this._focusY;\n  }\n\n  public get timeDelta() {\n    return this.currentTime - this.prevTime;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}