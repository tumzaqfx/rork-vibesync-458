{"ast":null,"code":"import _objectWithoutPropertiesLoose from\"@babel/runtime/helpers/objectWithoutPropertiesLoose\";const _excluded=[\"source\",\"events\",\"contentPosition\",\"hashPlaceholderContentPosition\",\"priority\",\"style\",\"hashPlaceholderStyle\",\"tintColor\",\"className\",\"accessibilityLabel\",\"cachePolicy\"];import React,{useEffect,useId}from'react';import ColorTintFilter,{getTintColorStyle}from'./ColorTintFilter';import{getImageWrapperEventHandler}from'./getImageWrapperEventHandler';import{useHeaders,useImageHashes}from'./hooks';import{absoluteFilledPosition,getObjectPositionFromContentPositionObject}from'./positioning';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function getFetchPriorityFromImagePriority(priority='normal'){return priority&&['low','high'].includes(priority)?priority:'auto';}function getImgPropsFromSource(source){if(source&&'srcset'in source){return{srcSet:source.srcset,sizes:source.sizes};}return{};}const ImageWrapper=React.forwardRef((_ref,ref)=>{let{source,events,contentPosition,hashPlaceholderContentPosition,priority,style,hashPlaceholderStyle,tintColor,className,accessibilityLabel,cachePolicy}=_ref,props=_objectWithoutPropertiesLoose(_ref,_excluded);useEffect(()=>{events?.onMount?.forEach(e=>e?.());},[]);const tintId=useId();const{resolvedSource,isImageHash}=useImageHashes(source);const objectPosition=getObjectPositionFromContentPositionObject(isImageHash?hashPlaceholderContentPosition:contentPosition);const sourceWithHeaders=useHeaders(resolvedSource,cachePolicy,events?.onError);if(!sourceWithHeaders){return null;}return _jsxs(_Fragment,{children:[_jsx(ColorTintFilter,{id:tintId,tintColor:tintColor}),_jsx(\"img\",Object.assign({ref:ref,alt:accessibilityLabel,className:className,src:sourceWithHeaders?.uri||undefined,style:Object.assign({objectPosition},absoluteFilledPosition,getTintColorStyle(tintId,tintColor),style,isImageHash?hashPlaceholderStyle:{}),fetchPriority:getFetchPriorityFromImagePriority(priority||'normal')},getImageWrapperEventHandler(events,sourceWithHeaders),getImgPropsFromSource(source),props),source?.uri)]});});export default ImageWrapper;","map":{"version":3,"names":["React","useEffect","useId","ColorTintFilter","getTintColorStyle","getImageWrapperEventHandler","useHeaders","useImageHashes","absoluteFilledPosition","getObjectPositionFromContentPositionObject","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","getFetchPriorityFromImagePriority","priority","includes","getImgPropsFromSource","source","srcSet","srcset","sizes","ImageWrapper","forwardRef","_ref","ref","events","contentPosition","hashPlaceholderContentPosition","style","hashPlaceholderStyle","tintColor","className","accessibilityLabel","cachePolicy","props","_objectWithoutPropertiesLoose","_excluded","onMount","forEach","e","tintId","resolvedSource","isImageHash","objectPosition","sourceWithHeaders","onError","children","id","Object","assign","alt","src","uri","undefined","fetchPriority"],"sources":["/home/user/rork-vibesync-458/node_modules/expo-image/src/web/ImageWrapper.tsx"],"sourcesContent":["import React, { useEffect, Ref, useId } from 'react';\n\nimport ColorTintFilter, { getTintColorStyle } from './ColorTintFilter';\nimport { ImageWrapperProps } from './ImageWrapper.types';\nimport { getImageWrapperEventHandler } from './getImageWrapperEventHandler';\nimport { useHeaders, useImageHashes } from './hooks';\nimport { absoluteFilledPosition, getObjectPositionFromContentPositionObject } from './positioning';\nimport { SrcSetSource } from './useSourceSelection';\nimport { ImageNativeProps, ImageSource } from '../Image.types';\n\nfunction getFetchPriorityFromImagePriority(priority: ImageNativeProps['priority'] = 'normal') {\n  return priority && ['low', 'high'].includes(priority) ? priority : 'auto';\n}\n\nfunction getImgPropsFromSource(source: ImageSource | SrcSetSource | null | undefined) {\n  if (source && 'srcset' in source) {\n    return {\n      srcSet: source.srcset,\n      sizes: source.sizes,\n    };\n  }\n  return {};\n}\n\nconst ImageWrapper = React.forwardRef(\n  (\n    {\n      source,\n      events,\n      contentPosition,\n      hashPlaceholderContentPosition,\n      priority,\n      style,\n      hashPlaceholderStyle,\n      tintColor,\n      className,\n      accessibilityLabel,\n      cachePolicy,\n      ...props\n    }: ImageWrapperProps,\n    ref: Ref<HTMLImageElement>\n  ) => {\n    useEffect(() => {\n      events?.onMount?.forEach((e) => e?.());\n    }, []);\n\n    const tintId = useId();\n\n    // Thumbhash uri always has to start with 'thumbhash:/'\n    const { resolvedSource, isImageHash } = useImageHashes(source);\n    const objectPosition = getObjectPositionFromContentPositionObject(\n      isImageHash ? hashPlaceholderContentPosition : contentPosition\n    );\n\n    const sourceWithHeaders = useHeaders(resolvedSource, cachePolicy, events?.onError);\n    if (!sourceWithHeaders) {\n      return null;\n    }\n    return (\n      <>\n        <ColorTintFilter id={tintId} tintColor={tintColor} />\n        <img\n          ref={ref}\n          alt={accessibilityLabel}\n          className={className}\n          src={sourceWithHeaders?.uri || undefined}\n          key={source?.uri}\n          style={{\n            objectPosition,\n            ...absoluteFilledPosition,\n            ...getTintColorStyle(tintId, tintColor),\n            ...style,\n            ...(isImageHash ? hashPlaceholderStyle : {}),\n          }}\n          // @ts-ignore\n          // eslint-disable-next-line react/no-unknown-property\n          fetchPriority={getFetchPriorityFromImagePriority(priority || 'normal')}\n          {...getImageWrapperEventHandler(events, sourceWithHeaders)}\n          {...getImgPropsFromSource(source)}\n          {...props}\n        />\n      </>\n    );\n  }\n);\n\nexport default ImageWrapper;\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}