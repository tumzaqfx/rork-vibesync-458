{"ast":null,"code":"'use strict';import{isSharedValue}from\"../isSharedValue.js\";import{isChromeDebugger}from\"../PlatformChecker.js\";import{WorkletEventHandler}from\"../WorkletEventHandler.js\";import{initialUpdaterRun}from\"../animation/index.js\";import{hasInlineStyles,getInlineStyle}from\"./InlinePropManager.js\";import{flattenArray,has}from\"./utils.js\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";function dummyListener(){}export class PropsFilter{_initialStyle={};filterNonAnimatedProps(component){const inputProps=component.props;const props={};for(const key in inputProps){const value=inputProps[key];if(key==='style'){const styleProp=inputProps.style;const styles=flattenArray(styleProp??[]);const processedStyle=styles.map(style=>{if(style&&style.viewDescriptors){if(component._isFirstRender){this._initialStyle=Object.assign({},style.initial.value,this._initialStyle,initialUpdaterRun(style.initial.updater));}return this._initialStyle;}else if(hasInlineStyles(style)){return getInlineStyle(style,component._isFirstRender);}else{return style;}});props[key]=StyleSheet.flatten(processedStyle);}else if(key==='animatedProps'){const animatedProp=inputProps.animatedProps;if(animatedProp.initial!==undefined){Object.keys(animatedProp.initial.value).forEach(initialValueKey=>{props[initialValueKey]=animatedProp.initial?.value[initialValueKey];});}}else if(has('workletEventHandler',value)&&value.workletEventHandler instanceof WorkletEventHandler){if(value.workletEventHandler.eventNames.length>0){value.workletEventHandler.eventNames.forEach(eventName=>{props[eventName]=has('listeners',value.workletEventHandler)?value.workletEventHandler.listeners[eventName]:dummyListener;});}else{props[key]=dummyListener;}}else if(isSharedValue(value)){if(component._isFirstRender){props[key]=value.value;}}else if(key!=='onGestureHandlerStateChange'||!isChromeDebugger()){props[key]=value;}}return props;}}","map":{"version":3,"names":["isSharedValue","isChromeDebugger","WorkletEventHandler","initialUpdaterRun","hasInlineStyles","getInlineStyle","flattenArray","has","StyleSheet","dummyListener","PropsFilter","_initialStyle","filterNonAnimatedProps","component","inputProps","props","key","value","styleProp","style","styles","processedStyle","map","viewDescriptors","_isFirstRender","Object","assign","initial","updater","flatten","animatedProp","animatedProps","undefined","keys","forEach","initialValueKey","workletEventHandler","eventNames","length","eventName","listeners"],"sources":["/home/user/rork-vibesync-458/node_modules/react-native-reanimated/src/createAnimatedComponent/PropsFilter.tsx"],"sourcesContent":["'use strict';\n\nimport type { StyleProps } from '../commonTypes';\nimport { isSharedValue } from '../isSharedValue';\nimport { isChromeDebugger } from '../PlatformChecker';\nimport { WorkletEventHandler } from '../WorkletEventHandler';\nimport { initialUpdaterRun } from '../animation';\nimport { hasInlineStyles, getInlineStyle } from './InlinePropManager';\nimport type {\n  AnimatedComponentProps,\n  AnimatedProps,\n  InitialComponentProps,\n  IAnimatedComponentInternal,\n  IPropsFilter,\n} from './commonTypes';\nimport { flattenArray, has } from './utils';\nimport { StyleSheet } from 'react-native';\n\nfunction dummyListener() {\n  // empty listener we use to assign to listener properties for which animated\n  // event is used.\n}\n\nexport class PropsFilter implements IPropsFilter {\n  private _initialStyle = {};\n\n  public filterNonAnimatedProps(\n    component: React.Component<unknown, unknown> & IAnimatedComponentInternal\n  ): Record<string, unknown> {\n    const inputProps =\n      component.props as AnimatedComponentProps<InitialComponentProps>;\n    const props: Record<string, unknown> = {};\n    for (const key in inputProps) {\n      const value = inputProps[key];\n      if (key === 'style') {\n        const styleProp = inputProps.style;\n        const styles = flattenArray<StyleProps>(styleProp ?? []);\n        const processedStyle: StyleProps[] = styles.map((style) => {\n          if (style && style.viewDescriptors) {\n            // this is how we recognize styles returned by useAnimatedStyle\n            if (component._isFirstRender) {\n              this._initialStyle = {\n                ...style.initial.value,\n                ...this._initialStyle,\n                ...initialUpdaterRun<StyleProps>(style.initial.updater),\n              };\n            }\n            return this._initialStyle;\n          } else if (hasInlineStyles(style)) {\n            return getInlineStyle(style, component._isFirstRender);\n          } else {\n            return style;\n          }\n        });\n        props[key] = StyleSheet.flatten(processedStyle);\n      } else if (key === 'animatedProps') {\n        const animatedProp = inputProps.animatedProps as Partial<\n          AnimatedComponentProps<AnimatedProps>\n        >;\n        if (animatedProp.initial !== undefined) {\n          Object.keys(animatedProp.initial.value).forEach((initialValueKey) => {\n            props[initialValueKey] =\n              animatedProp.initial?.value[initialValueKey];\n          });\n        }\n      } else if (\n        has('workletEventHandler', value) &&\n        value.workletEventHandler instanceof WorkletEventHandler\n      ) {\n        if (value.workletEventHandler.eventNames.length > 0) {\n          value.workletEventHandler.eventNames.forEach((eventName) => {\n            props[eventName] = has('listeners', value.workletEventHandler)\n              ? (\n                  value.workletEventHandler.listeners as Record<string, unknown>\n                )[eventName]\n              : dummyListener;\n          });\n        } else {\n          props[key] = dummyListener;\n        }\n      } else if (isSharedValue(value)) {\n        if (component._isFirstRender) {\n          props[key] = value.value;\n        }\n      } else if (key !== 'onGestureHandlerStateChange' || !isChromeDebugger()) {\n        props[key] = value;\n      }\n    }\n    return props;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}